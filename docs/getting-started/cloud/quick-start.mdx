---
sidebar_position: 1
---

# Quick start

The Invoice-Collector API is organized around REST. Our API has predictable resource-oriented URLs, accepts JSON-encoded request bodies, returns JSON-encoded responses, and uses standard HTTP response codes, authentication, and verbs.

The server base url is:

```
https://api.invoice-collector.com/api/v1
```

In this documentation, the following terms are used:

- **Customer**: Refers to the company which has a contract with Invoice-Collector.
- **User**: Refers to the individual users of Invoice-Collector, offen users of our customers.

## Authentication

#### Bearer Token Authentication

This authentication method is reserved for customer endpoints only. It involves sending the token in the Authorization header of the HTTP request.

```bash
curl -H "Authorization: Bearer <bearer_token>" https://invoice-collector.com/api/v1/example
```

You can request a new bearer token anytime here by providing the email used to contact the Invoice-Collector team.
Be aware that we do not have access to your bearer token and it must be keeped safe. **This token has an unlimited exipery duration.**

<!-- TODO ADD BUTTON TO BEARER RESET -->

#### User token

This authentication method is reserved for user endpoints only. It involves appending the token as a query parameter in the URL.
We will see below that user tokens have a short expiry duration.

```bash
curl https://api.invoice-collector.com/api/v1/example?token=<token>
```

## First request

We will start with a simple request to the endpoint `/customer` to retreive your informations:

```bash
curl -H "Authorization: Bearer <bearer_token>" https://invoice-collector.com/api/v1/customer
```

Json body response:

```json
{
  callback: "https://path.to/callback"
}
```

This is the `callback` at which invoices will be sent. Please email us at contact@invoice-collector.com to update your `callback`. An automatic process will be setup soon.

## Generate a user token

To generate a user token, you need to make a POST request to the `/authorize` endpoint.

```bash
curl -X POST https://api.invoice-collector.com/api/v1/authorize \
    -H "Authorization: Bearer <bearer_token>" \
    -H "Content-Type: application/json" \
    -d '{
        "email": "user@example.com",
        "locale": "fr",
        "remote_id": "A1B2C3D4"
    }'
```

- `email` is required to send the terms of use, allong with a verification code to the new user, it is never stored in the database. The email is immediatly sent immediatly.
- `locale` is the language of the user. Only `fr` and `en` are currently available.
- `remote_id` is used to identify the user on your system. All invoices sent to your `callback` will contain the `remote_id` allong with it. 

Json body response:

```json
{
  token: "fca8a33006220b69dfc922596e77ffe1c2fe5d9f89664fe78f305ac836927fe52a788208d2f881fb829141eac12d2c384468d5e6a89c92dbe40f64a1366d2f22"
}
```

This user `token` has an exipry duration of 10 minutes and can be used to add and remove collectors.

## Add and remove collectors

Once you have the user token, you must redirect him to the following endpoint to be rendered **in a browser or an iframe**: [`https://api.invoice-collector.com/api/v1/user?token=<token>`](https://api.invoice-collector.com/api/v1/user?token=<token>)

1. The user is asked to accept the [Terms of Use](https://invoice-collector.com/terms-of-use) and enter the verification code sent to the email provided in the `/authorize` request.
2. The user can add a new collector and remove an existing collector.
3. New invoices only will be sent to the `callback` endpoint allong with the `remote_id`.

:::note

Users who have already accepted the [Terms of Use](https://invoice-collector.com/terms-of-use) will not receive a new email and will not be asked to accept them again.

:::

<!-- TODO ADD BUTTON TO DEMO -->

## Remove a user

If automatic invoice collection is no longer needed for a user, it can be removed:

```bash
curl -X DELETE https://api.invoice-collector.com/api/v1/user \
    -H "Authorization: Bearer <bearer_token>" \
    -H "Content-Type: application/json" \
    -d '{
        "remote_id": "A1B2C3D4"
    }'
```

All the credentials, collectors and user informations will be removed from the database.

:::note

Please refer to the [API Reference](../../api.mdx) for more advanced requests.

:::